import Head from "next/head"
import Layout from "@/components/layout"

import { useState, useEffect } from "react";

import { v4 as uuidv4 } from 'uuid';

import IntroSpace from "@/pages/intro"
import MainSpace from "@/components/spaces/main"
import DreamSpace from "@/components/spaces/dream"
import UpdatesSpace from "@/components/spaces/updates";

import NavIcons from "@/components/nav-icons";

import NavSignboard from "@/components/nav-signboard";

export default function Home() {

  const [ expandSky, setExpandSky ] = useState(false)
  const [ showSignpost, setShowSignpost ] = useState(false)

  // TODO: Don't just use main, check for the current id from the url
  const [ currentSpaceIndex, setCurrentSpaceIndex ] = useState(0)

  const gardenSpaces = [
    {id: 'intro', component: <IntroSpace/>},
    {id: 'main', component: <MainSpace expandSky={expandSky}/>}, 
    {id: 'updates', component: <UpdatesSpace />},
    {id: 'dream', component: <DreamSpace/>}
  ]

  const layoutContainerWidth = 150

  const renderNavSigns = () => {
    const prev = <button onClick={() => setCurrentSpaceIndex(currentSpaceIndex - 1)}>Go to previous space</button>
    const next = <button onClick={() => setCurrentSpaceIndex(currentSpaceIndex + 1)}>Go to next space</button>

    const style = {
      display: 'flex',
      justifyContent: currentSpaceIndex > 0 && currentSpaceIndex < gardenSpaces.length ? 'space-between' : 'flex-end',
      position: 'absolute',
      width: '100%',
      top: '50%'
    }

    if(currentSpaceIndex === 0){ return <div style={style}>{next}</div> }
    else if(currentSpaceIndex === gardenSpaces.length -1 ){ return <div style={style}>{prev}</div> }
    else return <div style={style}>{prev}{next}</div>
  }

  return (
    <>
    <Head>
        <title>uzomas.garden</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Layout containerWidth={layoutContainerWidth}>
        { gardenSpaces[currentSpaceIndex].component }
        <NavIcons expandSky={expandSky} setExpandSky={setExpandSky} 
          showSignpost={showSignpost} setShowSignpost={setShowSignpost}
        />
        { 
          showSignpost && 
            <NavSignboard 
              signs={signs} 
              spaceIds={spaceIds} 
              currentSpaceId={currentSpaceId} 
              setCurrentSpaceId={setCurrentSpaceId}
            />
        }
        { renderNavSigns() }
      </Layout>
    </>
  )
}
