import Head from "next/head"
import { fetchGraphQL } from "@/utils/contentful"
import { queries } from '@/utils/query'
import { useState, useEffect } from "react"
import styles from '@/styles/Home.module.css'
import Image from "next/image"
import cloud from '../public/images/cloud-1.png'

export default function Home() {

  const [thoughts, setThoughts] = useState(null)

  useEffect(() => {
    fetchGraphQL(queries.thoughts)
      .then((thoughts) => {setThoughts(thoughts.data.blogPostCollection.items)})
  
    return () => {}
  }, [])

  const cloudTopPositions = [10,20,30,40,50,60,70]

  return (
    <>
    <Head>
        <title>uzomas.garden</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main id='garden'>
        <div id='sky'>
          {
            thoughts && thoughts.map(({slug, title}, index) => 
              <div className={styles.cloud} key={slug} style={{
                  animationDelay: `${index*10}s`,
                  top: `${cloudTopPositions[Math.floor(Math.random()*cloudTopPositions.length)]}px`
                }}>
                <h3>{title}</h3>
              </div>
            )
          }
        </div>
        <div id='ground'>
        </div>
      </main>
    </>
  )
}
